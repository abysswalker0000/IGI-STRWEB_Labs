{% extends 'base.html' %}

{% block title %}
News
{% endblock %}

{% block content %}
<style>
    .news-item {
        background-color: #f9f9f9;
        border: 2px solid #454545;
        border-radius: 8px;
        padding: 15px;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        overflow: hidden;
        height: 450px; 
        max-width: 100%; 
        background: repeating-linear-gradient(
            -40deg,
            rgba(20, 20, 20, 0.9), 
            rgba(20, 20, 20, 0.9) 8px,
            rgba(51, 51, 51, 0.9) 8px, 
            rgba(51, 51, 51, 0.9) 15px
        );
    }

    .news-image {
        width: 100%;
        height: 280px;
        margin-bottom: 10px;
        border-radius: 4px;
        background-color: #060606;
        object-fit: cover;
    }

    .news-title {
        font-size: 20px;
        margin: 10px 5px;
        text-align:center;
        color: #cf9102;
    }

    .news-description {
        height: 1.2em; 
        overflow: hidden; 
        text-overflow: ellipsis; 
        white-space: nowrap;  
        padding-left:5px;
    }

    .read-more-button {
        display: flex;
        justify-content: center;
        align-items: center;
        border: 2px solid black; 
        color: white;
        padding: 10px 15px;
        border-radius: 4px;
        cursor: crosshair;
        background-color: #404040;
    }
    .read-more-button:hover {
        border-color: #a37303;
    }
    .read-more-button:hover span {
        animation: blink 0.9s infinite; 
    }

    @keyframes blink {
        0%, 100% {
            opacity: 1; 
        }
        50% {
            opacity: 0; 
        }
    }
    .news-container {
        display: grid;
        grid-template-columns: repeat(3, minmax(300px, 1fr));
        gap: 20px;
        padding: 20px;
        width: 80%;
        max-width: 1200px;
        margin-left: auto;
        margin-right: auto;
        background: repeating-linear-gradient(
            -40deg,
            rgba(5, 5, 5, 0.9), 
            rgba(5, 5, 5, 0.9) 8px,
            rgba(18, 18, 18, 0.9) 8px, 
            rgba(18, 18, 18, 0.9) 15px
        );
    }

    .news-content-wrapper {
        background-color: rgba(0, 0, 0, 0.5);
        padding-top: 40px;
        position: relative; /* Добавлено для позиционирования колес */
        overflow: hidden; /* Скрываем колеса за пределами блока */
    }

    .news-block-title {
        text-align: center;
        margin: 0 auto;
        border: 2px solid #454545;
        width: 80%;
        max-width: 1200px;
        padding: 10px 20px;
        font-size: 20px;
        background: repeating-linear-gradient(
            -40deg,
            rgba(20, 20, 20, 0.9), 
            rgba(20, 20, 20, 0.9) 8px,
            rgba(51, 51, 51, 0.9) 8px, 
            rgba(51, 51, 51, 0.9) 15px
        );
        -webkit-text-stroke: 0.5px black;
    }

    /* Стили для падающих колес */
    .wheel {
        position: absolute;
        top: -100px;
        left: 0;
        width: 50px;
        height: 50px;
        background-image: url("../static/background/wheel2.png");
        background-size: contain;
        background-repeat: no-repeat;
        pointer-events: none; /* Чтобы колеса не перекрывали элементы */
        animation: fall linear forwards;
    }

    @keyframes fall {
        to {
            transform: translateY(120vh) rotate(360deg);
            opacity: 0;
        }
    }
</style>
<div class="news-content-wrapper">
    <div class="news-block-title">
        <h1 class="gotic-font" style="margin:5px;">Latest News</h1>
        <p style="margin:5px;">Read about our best customers</p>
    </div>
    <div class="news-container">
        {% for news_item in news %}
        <div class="news-item">
            <img src="{{ news_item.image.url }}" alt="{{ news_item.title }}" class="news-image">
            <h2 class="news-title">{{ news_item.title }}</h2>
            <p class="news-description">{{ news_item.smalldescription }}</p>
            <a href="{% url 'news_detail' news_item.id %}" class="read-more-button"><span>Learn more...</span></a>
        </div>
        {% endfor %}
    </div>
</div>

<!-- Подключаем jQuery из CDN (для простоты работы с анимацией) -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<script>

    $(document).ready(function() {
        var wheelImages = ["../static/background/wheel2.png"]; // Путь к изображению колеса

        // Функция для создания колеса
        function createWheel() {
            var wheel = $('<div class="wheel"></div>');
            var size = Math.random() * 30 + 20; // Размеры от 20 до 50 пикселей
            var startPos = Math.random() * $(window).width();
            var duration = Math.random() * 3 + 2; // Длительность от 2 до 5 секунд

            wheel.css({
                left: startPos + 'px',
                width: size + 'px',
                height: size + 'px',
                backgroundImage: 'url(' + wheelImages[0] + ')',
                animationDuration: duration + 's',
                transform: 'rotate(' + (Math.random() * 360) + 'deg)'
            });

            $('.news-content-wrapper').append(wheel);

            // Удаляем колесо после завершения анимации
            wheel.on('animationend', function() {
                $(this).remove();
            });
        }

        // Обработчик события прокрутки
        $(window).on('scroll', function() {
            // Проверяем, находится ли блок в зоне видимости
            var newsWrapper = $('.news-content-wrapper');
            var windowBottom = $(window).scrollTop() + $(window).height();
            var newsTop = newsWrapper.offset().top;
            var newsBottom = newsTop + newsWrapper.height();

            if (windowBottom > newsTop && $(window).scrollTop() < newsBottom) {
                // Создаём колеса с интервалом
                createWheel();
            }
        });
    });
</script>
{% endblock %}
